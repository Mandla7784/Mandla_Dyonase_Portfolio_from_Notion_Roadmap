"use client";

import { useState, type ReactElement } from "react";

const iconClass = "w-6 h-6 shrink-0 text-accent";

// Images in public/skills/ and public/icons/ â€“ map skill name to path
const skillToImagePath: Record<string, string> = {
  JavaScript: "/skills/js.png",
  Java: "/skills/java.png",
  Docker: "/skills/icons8-docker-48.png",
  Figma: "/skills/icons8-figma-48.png",
  Git: "/skills/icons8-git-48.png",
  Python: "/icons/python.png",
  "Tailwind CSS": "/skills/css-3.png",
};
const skillToSlug: Record<string, string> = {
  JavaScript: "javascript",
  TypeScript: "typescript",
  Python: "python",
  Java: "java",
  React: "react",
  "Next.js": "nextjs",
  "Tailwind CSS": "tailwindcss",
  Bootstrap: "bootstrap",
  "Framer Motion": "framer-motion",
  "Node.js": "nodejs",
  PostgreSQL: "postgresql",
  "REST APIs": "rest",
  Docker: "docker",
  Git: "git",
  Linux: "linux",
  Vim: "vim",
  Figma: "figma",
  "Responsive design": "responsive",
  "Accessibility (a11y)": "accessibility",
};

const fallbackIcons: Record<string, ReactElement> = {
  JavaScript: <svg viewBox="0 0 24 24" fill="currentColor" className={iconClass}><path d="M3 3h18v18H3V3zm16.525 13.707c-.131-.821-.666-1.511-2.252-2.155-.552-.259-1.165-.438-1.349-.905-.091-.272-.055-.439-.231-.601-.229-.23-.55-.301-.813-.255-.72.086-1.063.665-1.459 1.219-.506.659-.862.764-1.377.602-.107-.028-.214-.055-.32-.082-.323-.084-.46-.149-.595-.346-.146-.21-.111-.439-.111-.663 0-.642.333-1.154.736-1.504 1.237-1.05 3.152-1.249 4.281-1.341 1.083-.09 2.154.045 2.711 1.178.382.76.242 1.815-.694 2.411-1.074.687-2.709 1.078-2.923 2.278-.133.907.767 1.416 1.744 1.416.433 0 .873-.08 1.273-.242 1.005-.333 1.659-1.045 2.008-2.102zm-6.737-5.434h-2.248c0 1.938-.009 3.864-.009 5.802 0 .924.047 1.772-.104 2.033-.247.517-.886.451-1.175.359-.297-.146-.448-.349-.623-.641-.047-.078-.082-.146-.095-.146l-1.668.844c.065.143.136.283.225.421.527.797 1.688 1.256 2.868 1.311 1.179.053 2.35-.254 3.018-.965.771-.838.776-1.98.776-3.164v-5.475z" /></svg>,
  TypeScript: <svg viewBox="0 0 24 24" fill="currentColor" className={iconClass}><path d="M3 3h18v18H3V3zm10.71 14.86c.5.98 1.51 1.73 3.09 1.73 1.6 0 2.8-.83 2.8-2.36 0-1.41-.81-2.04-2.25-2.66l-.42-.18c-.73-.31-1.04-.52-1.04-1.02 0-.41.33-.73.81-.73.48 0 .8.21 1.09.73l1.31-.87c-.55-.96-1.33-1.33-2.4-1.33-1.51 0-2.48.96-2.48 2.23 0 1.38.81 2.03 2.03 2.55l.42.18c.78.34 1.24.55 1.24 1.13 0 .48-.45.83-1.15.83-.83 0-1.31-.43-1.67-1.03l-1.38.8z" /></svg>,
  Python: <svg viewBox="0 0 24 24" fill="currentColor" className={iconClass}><path d="M14.25.18l.9.2.73.26.59.3.45.32.34.34.25.34.16.33.1.3.04.26.02.2-.01.13V8.5l-.05.63-.13.55-.21.46-.26.38-.31.31-.35.25-.38.19-.4.14-.42.1-.43.06-.41.03-.38-.01-.35-.04-.31-.07-.28-.1-.24-.12-.2-.15-.16-.16-.13-.18-.09-.18-.06-.17-.03-.15-.01-.13.01-.1.03-.08.05-.05.06-.03.06-.01.05.01h.05l.03.01.04.02.04.02.05.02.05.02.06.01.07.02.08.01 1.76.02.89.02.67-.01.5-.03.38-.05.29-.07.22-.08.16-.1.12-.1.08-.1.05-.08.02-.06-.01-.04-.02-.03-.03-.02-.02-.04-.01-.04.01-.03.02-.02.03-.01.03v-.02h.02l.01.01h.02l.02.01h.01l.01-.01h-.01v-.01h-.02l-.02-.01h-.01l-.02-.01-.02-.02-.02-.02-.02-.02-.02-.03-.01-.03-.01-.04.01-.04.02-.05.03-.06.04-.07.05-.08.07-.09.08-.1.1-.11.12-.12.14-.12.16-.12.18-.11.2-.1.22-.08.24-.07.26-.05.28-.03.3-.01h.32l.32.02.3.04.28.06.26.08.24.1.22.12.2.14.18.16.16.18.14.2.12.22.1.24.08.26.06.28.04.3.02.32-.01.34-.03.36-.05.38-.07.4-.09.42-.11.44-.13.46-.15.48-.17.5-.19.52-.21.54-.23.56-.25.58-.27.6-.29.62-.31.64-.33.66-.35.68-.37.7-.39.72-.41.74-.43.76-.45.78-.47.8-.49.82-.51.84-.53.86-.55.88-.57.9-.59.92-.61.94-.63.96-.65.98-.67 1-.69 1.02-.71 1.04-.73 1.06-.75 1.08-.77 1.1-.79 1.12-.81 1.14-.83 1.16-.85 1.18-.87 1.2-.89 1.22-.91 1.24-.93 1.26-.95 1.28-.97 1.3-.99 1.32-1.01 1.34-1.03 1.36-1.05 1.38-1.07 1.4-1.09 1.42-1.11 1.44-1.13 1.46-1.15 1.48-1.17 1.5-1.19 1.52-1.21 1.54-1.23 1.56-1.25 1.58-1.27 1.6-1.29 1.62-1.31 1.64-1.33 1.66-1.35 1.68-1.37 1.7-1.39 1.72-1.41 1.74-1.43 1.76-1.45 1.78-1.47 1.8-1.49 1.82-1.51 1.84-1.53 1.86-1.55 1.88-1.57 1.9-1.59 1.92-1.61 1.94-1.63 1.96-1.65 1.98-1.67 2-1.69z" /></svg>,
  Java: <svg viewBox="0 0 24 24" fill="currentColor" className={iconClass}><path d="M8.851 18.56s-.917.534.653.714c1.902.172 2.874.117 4.969-.211 0 0 .552.346 1.321.646-4.699 2.013-10.633-.118-6.943-1.149M8.276 15.933s-1.028.761.542.924c2.032.209 3.636.227 6.413-.308 0 0 .384.389.987.602-5.679 1.661-12.007.17-7.942-1.218z" /></svg>,
  React: <svg viewBox="0 0 24 24" fill="currentColor" className={iconClass}><path d="M14.23 12.004a2.236 2.236 0 0 1-2.235 2.236 2.236 2.236 0 0 1-2.236-2.236 2.236 2.236 0 0 1 2.236-2.236 2.236 2.236 0 0 1 2.235 2.236z" /></svg>,
  "Next.js": <svg viewBox="0 0 24 24" fill="currentColor" className={iconClass}><path d="M11.57 0L4.64 22.98c.14.03.28.04.43.04.14 0 .28-.01.42-.04l2.02-5.28 2.36 6.05c.07.16.23.27.4.27s.33-.11.4-.27l4.08-10.42 1.51 3.86c.07.16.23.27.4.27.17 0 .33-.11.4-.27l2.93-7.48L11.57 0z" /></svg>,
  "Tailwind CSS": <svg viewBox="0 0 24 24" fill="currentColor" className={iconClass}><path d="M12.001 4.8c-3.2 0-5.2 1.6-6 4.8 1.2-1.6 2.6-2.2 4.2-2.2 2.4 0 3.8 1.6 4.2 3.6.3-.1.6-.2.9-.2 2.4 0 4.2 2 4.2 4.8 0 3.6-2.2 6.6-6 6.6-3.6 0-6-2.4-6-6 0-4.4 3.2-7.6 7.5-7.6.3 0 .6 0 .9.1-.2.8-.3 1.6-.3 2.4 0 2.4 1.2 4.4 3 5.8.3-.2.6-.4.9-.6-1.6-.9-2.7-2.6-2.7-4.6 0-2 1.2-3.4 3.2-4.2-.6-1.2-1-2-1-3.2 0-2.8 2.2-4.8 5.2-4.8z" /></svg>,
  Bootstrap: <svg viewBox="0 0 24 24" fill="currentColor" className={iconClass}><path d="M11.77 11.24H9.956V8.202h2.152c1.27 0 2.16.59 2.16 1.52 0 .97-.89 1.52-2.16 1.52zM12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0z" /></svg>,
  "Framer Motion": <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={iconClass}><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" /></svg>,
  "Node.js": <svg viewBox="0 0 24 24" fill="currentColor" className={iconClass}><path d="M11.998 24c-.321 0-.641-.084-.922-.247l-2.936-1.737c-.438-.245-.224-.332-.08-.383.585-.203.703-.25 1.328-.604.065-.037.151-.023.218.017l2.256 1.339a.29.29 0 0 0 .272 0l8.795-5.076a.277.277 0 0 0 .135-.238V6.921a.283.283 0 0 0-.138-.242l-8.791-5.072a.278.278 0 0 0-.271 0L3.075 6.68a.284.284 0 0 0-.139.241v10.15c0 .102.055.197.144.245l2.409 1.392c1.307.654 2.108-.116 2.108-.89V7.787c0-.142.114-.253.256-.253h1.115c.139 0 .255.111.255.253v10.021c0 1.745-.95 2.745-2.604 2.745-.508 0-.909 0-2.026-.551L2.28 18.675a2.484 2.484 0 0 1-1.281-2.125V6.921c0-.897.475-1.72 1.244-2.165l8.795-5.082a2.575 2.575 0 0 1 2.454 0l8.794 5.082c.769.445 1.244 1.268 1.244 2.165v10.15c0 .893-.475 1.72-1.244 2.163l-8.794 5.078a2.587 2.587 0 0 1-1.227.307z" /></svg>,
  PostgreSQL: <svg viewBox="0 0 24 24" fill="currentColor" className={iconClass}><path d="M18.5 15.5c-.5 0-1-.5-1.5-1 0-.2.1-.4.2-.6.2-.4.3-.9.3-1.4 0-1.2-.5-2.4-1.3-3.2-.8-.8-1.9-1.3-3.2-1.3-1.3 0-2.4.5-3.2 1.3-.8.8-1.3 2-1.3 3.2 0 .5.1 1 .3 1.4.1.2.2.4.2.6-.5.5-1 1-1.5 1-1.7 1.7-2.5 4-2.5 6.5 0 .6.1 1.2.2 1.8h12.6c.1-.6.2-1.2.2-1.8 0-2.5-.8-4.8-2.5-6.5z" /></svg>,
  "REST APIs": <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={iconClass}><circle cx="12" cy="12" r="3" /><path d="M12 1v4M12 19v4M4.22 4.22l2.83 2.83M16.95 16.95l2.83 2.83M1 12h4M19 12h4M4.22 19.78l2.83-2.83M16.95 7.05l2.83-2.83" /></svg>,
  Docker: <svg viewBox="0 0 24 24" fill="currentColor" className={iconClass}><path d="M13.983 10.779h2.738V8.004h-2.738zm-3.244 0h2.738V8.004h-2.738z" /></svg>,
  Git: <svg viewBox="0 0 24 24" fill="currentColor" className={iconClass}><path d="M23.546 10.93L13.067.452c-.604-.603-1.582-.603-2.188 0L8.708 2.627l2.76 2.76c.645-.223 1.383-.065 1.896.45.516.515.675 1.254.45 1.9l2.66 2.66c.645-.223 1.387-.065 1.9.45.516.515.672 1.258.45 1.898l2.658 2.66c.644-.224 1.386-.066 1.9.45.514.514.67 1.256.447 1.9l2.605 2.6c.604.604 1.582.604 2.186 0 .604-.602.604-1.582 0-2.187L23.546 10.93z" /></svg>,
  Linux: <svg viewBox="0 0 24 24" fill="currentColor" className={iconClass}><path d="M12.504 0c-.155 0-.315.008-.48.021-4.226.333-3.105 4.807-3.17 6.298-.076 1.092-.3 1.953-1.05 3.02-.885 1.051-2.127 2.75-2.716 4.521-.278.832-.413 1.684-.506 2.528-.051.465-.092.93-.102 1.397-.023 1.074.132 2.18.478 3.206.484 1.431 1.332 2.574 2.545 3.381 1.213.807 2.857 1.259 4.61 1.259h.191c1.754 0 3.397-.452 4.61-1.259 1.213-.807 2.061-1.95 2.545-3.381.346-1.026.501-2.132.478-3.206-.01-.467-.051-.932-.102-1.397-.093-.844-.228-1.696-.506-2.528-.589-1.771-1.831-3.47-2.716-4.521-.75-1.067-.974-1.928-1.05-3.02-.065-1.491 1.056-5.965-3.17-6.298-.165-.013-.325-.021-.48-.021z" /></svg>,
  Vim: <svg viewBox="0 0 24 24" fill="currentColor" className={iconClass}><path d="M17.373 2.475L24 21.525 17.373 19.05 12 21.525 6.627 19.05 0 21.525 6.627 2.475 12 0l5.373 2.475z" /></svg>,
  Figma: <svg viewBox="0 0 24 24" fill="currentColor" className={iconClass}><path d="M15.852 8.981h-4.588V0h4.588c2.476 0 4.49 2.014 4.49 4.49s-2.014 4.491-4.49 4.491zM12.735 7.51h3.117a2.497 2.497 0 0 0 2.496-2.496 2.497 2.497 0 0 0-2.496-2.496H12.735V7.51z" /></svg>,
  "Responsive design": <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={iconClass}><rect x="2" y="4" width="20" height="16" rx="2" /><path d="M8 21h8M12 17v4" /></svg>,
  "Accessibility (a11y)": <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={iconClass}><circle cx="12" cy="4" r="2" /><path d="M12 8v12M8 12l4 4 4-4" /></svg>,
};

export default function SkillIcon({ name }: { name: string }) {
  const [imgFailed, setImgFailed] = useState(false);
  const exactPath = skillToImagePath[name];
  const slug = skillToSlug[name];
  const imgPath = exactPath || (slug ? `/icons/${slug}.png` : null);

  if (imgPath && !imgFailed) {
    return (
      <span className="w-6 h-6 shrink-0 flex items-center justify-center">
        <img
          src={imgPath}
          alt=""
          className="w-6 h-6 object-contain"
          onError={() => setImgFailed(true)}
        />
      </span>
    );
  }

  const icon = fallbackIcons[name];
  if (!icon) {
    return (
      <span className="w-6 h-6 shrink-0 rounded-full bg-accent/20 flex items-center justify-center text-accent text-xs font-bold">
        {name.charAt(0)}
      </span>
    );
  }
  return <span className="inline-flex items-center justify-center">{icon}</span>;
}
